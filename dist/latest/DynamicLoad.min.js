var DynamicLoad;
(function(f){var k=function(){function a(d,a){this.cloneNodes=[];if(d instanceof HTMLElement){var b=document.createElement("div");b.appendChild(d.cloneNode(!0));this.element=d;this.elemHTML=b.innerHTML;d.style.display="none";a&&(a.innerHTML="");this.parent=a||d.parentNode}else this.elemHTML=d,a&&(a.innerHTML=""),this.parent=a}a.prototype.bind=function(d){for(var a=1;a<this.cloneNodes.length;a++)this.parent.removeChild(this.cloneNodes[a].node);if(0!=this.cloneNodes.length){this.cloneNodes=[this.cloneNodes[0]];
for(var a=Object.keys(d),b=0;b<a.length;b++)if(this.cloneNodes[0].cloneData[a[b]]!=d[a[b]]){a=this.bindedNodes(d);for(b=a.length-1;0<=b;b--)this.parent.insertBefore(a[b],this.cloneNodes[0].nodes[this.cloneNodes[0].nodes.length-1].nextSibling);for(b=0;b<this.cloneNodes[0].nodes.length;b++)this.parent.removeChild(this.cloneNodes[0].nodes[b]);this.cloneNodes[0].nodes=a;this.cloneNodes[0].cloneData=JSON.parse(JSON.stringify(d));break}}else{for(var a=this.bindedNodes(d),e=this.element?this.element.nextSibling:
this.parent.firstChild,b=a.length-1;0<=b;b--)this.parent.insertBefore(a[b],e);this.cloneNodes.push({data:d,cloneData:JSON.parse(JSON.stringify(d)),nodes:a})}return this};a.prototype.refresh=function(){for(var d=0;d<this.cloneNodes.length;d++)for(var a=Object.keys(this.cloneNodes[d].data),b=0;b<a.length;b++)if(this.cloneNodes[d].cloneData[a[b]]!=this.cloneNodes[d].data[a[b]]){a=this.bindedNodes(this.cloneNodes[d].data);for(b=a.length-1;0<=b;b--)this.parent.insertBefore(a[b],this.cloneNodes[d].nodes[this.cloneNodes[d].nodes.length-
1].nextSibling);for(b=0;b<this.cloneNodes[d].nodes.length;b++)this.parent.removeChild(this.cloneNodes[d].nodes[b]);this.cloneNodes[d].nodes=a;this.cloneNodes[d].cloneData=JSON.parse(JSON.stringify(this.cloneNodes[d].data));break}return this};a.prototype.repeat=function(d,a){for(var b=0;b<this.cloneNodes.length;b++)-1==d.indexOf(this.cloneNodes[b].data)&&(this.parent.removeChild(this.cloneNodes[b].node),this.cloneNodes.splice(b,1),--b);a&&this.refresh();for(var e=this.cloneNodes.length-1,b=d.length-
1;0<=b;b--)if(-1!=e&&this.cloneNodes[e].data===d[b])e--;else{for(var g=this.bindedNodes(d[b]),f=-1==e?this.element?this.element.nextSibling:this.parent.firstChild:this.cloneNodes[e].nodes[this.cloneNodes[e].nodes.length-1].nextSibling,h=g.length-1;0<=h;h--)this.parent.insertBefore(g[h],f);this.cloneNodes.splice(e+1,0,{data:d[b],cloneData:JSON.parse(JSON.stringify(d[b])),nodes:g})}return this};a.prototype.bindedNodes=function(a){var c=document.createElement("div");c.innerHTML=this.elemHTML;if(a)for(var b=
Object.keys(a),e=0;e<b.length;e++)c.innerHTML=c.innerHTML.replace(new RegExp("{{"+b[e]+"}}","g"),a[b[e]]);return Array.prototype.slice.call(c.childNodes)};return a}();f.Element=k})(DynamicLoad||(DynamicLoad={}));
(function(f){var k=function(){function a(a,c,b){this.callback=[];this.method=a;this.url=c;this.setData(b)}a.prototype.addCallback=function(a){this.callback.push(a);return this};a.prototype.send=function(a){var c=this,b=this.callback,e=new XMLHttpRequest,g=function(e,g){e&&(c.status=e);g&&(c.responseText=g);var f;f="json"==a?JSON.parse(c.responseText):c.responseText;for(var r=0;r<b.length;r++)b[r](e,f)};if(this.status)g();else{var f=this.url+(-1==this.url.indexOf("?")?"?":"&")+"_="+(new Date).getTime();
e.open(this.method,f,!0);this.contentType&&e.setRequestHeader("Content-Type",this.contentType);this.auth&&e.setRequestHeader("Authorization",this.auth);e.onload=function(){g(e.status,e.responseText)};e.onerror=function(){g(e.status,e.responseText)};this.data?e.send(this.data):e.send()}};a.prototype.setAuth=function(a){this.auth=a;return this};a.prototype.setData=function(a){this.data=a;this.data instanceof FormData?this.contentType=void 0:"string"!=typeof this.data&&(this.data=JSON.stringify(this.data),
this.contentType="application/json");return this};a.prototype.asString=function(a){a&&this.addCallback(a);this.send("string")};a.prototype.asJson=function(a){a&&this.addCallback(a);this.send("json")};a.get=function(d){return new a("GET",d)};a.put=function(d,c){return(new a("PUT",d)).setData(c)};a.post=function(d,c){return(new a("POST",d)).setData(c)};a["delete"]=function(d,c){return(new a("DELETE",d)).setData(c)};return a}();f.Http=k})(DynamicLoad||(DynamicLoad={}));
(function(f){var k=function(){function a(a,c,b){this.type="text/css";this.rel="stylesheet";this.callback=[];this.href=a;c&&(this.type=c);b&&(this.rel=b)}a.prototype.addCallback=function(a){this.callback.push(a);return this};a.prototype.load=function(){var d=this;this.css=a.loaded[this.href];var c=function(){for(var a=0;a<d.callback.length;a++)d.callback[a]()};this.css&&0<this.css.count?(this.css.count+=1,c()):(a.loaded[this.href]={link:document.createElement("link"),count:1},this.css=a.loaded[this.href],
this.css.link.type=this.type,this.css.link.rel=this.rel,this.css.link.href=this.href,this.css.link.onload=c,a.head.appendChild(this.css.link));return this};a.prototype.destroy=function(){this.css||(this.css=a.loaded[this.href]);--this.css.count;return 0==this.css.count?(a.head.removeChild(this.css.link),this.css=a.loaded[this.href]=null,!0):!1};a.getInstance=function(d,c,b){return new a(d,c,b)};a.head=document.getElementsByTagName("head")[0];a.loaded={};return a}();f.LoadCss=k})(DynamicLoad||(DynamicLoad=
{}));
(function(f){var k=function(){function a(a){var c=this;this.isAppend=!1;this.callback=[];this.src=a;this.http=f.Http.get(a).addCallback(function(a,d){var g=document.createElement("div");g.innerHTML=d;if(c.dataBindRule)for(var f=Object.keys(c.dataBindRule),h=0;h<f.length;h++)g.innerHTML=g.innerHTML.replace(new RegExp("{{"+f[h]+"}}","g"),c.dataBindRule[f[h]]);c.isAppend||(c.element.innerHTML="");(function(a){for(var d=g.childNodes,b=0;b<d.length;b++)a.appendChild(d[b])})(c.element);componentHandler&&componentHandler.upgradeAllRegistered();
(function(){for(var g=0;g<c.callback.length;g++)c.callback[g](a,d)})()})}a.prototype.addCallback=function(a){this.callback.push(a);return this};a.prototype.put=function(a,c){this.element=a;this.isAppend=!1;this.dataBindRule=c;this.http.asString();return this};a.prototype.append=function(a,c){this.element=a;this.isAppend=!0;this.dataBindRule=c;this.http.asString();return this};a.prototype.destroy=function(a){a&&(this.element=a);this.element&&(this.element.innerHTML="")};a.getInstance=function(d){return new a(d)};
return a}();f.LoadHtml=k})(DynamicLoad||(DynamicLoad={}));
(function(f){var k=function(){function a(a,c){this.type="text/javascript";this.callback=[];this.src=a;c&&(this.type=c)}a.prototype.addCallback=function(a){a&&this.callback.push(a);return this};a.prototype.load=function(){var d=this;this.js=a.loaded[this.src];var c=function(){for(var a=0;a<d.callback.length;a++)d.callback[a]()};if(this.js&&0<this.js.count)this.js.count+=1,c();else{var b=this.src+(-1==this.src.indexOf("?")?"?":"&")+"_="+(new Date).getTime();a.loaded[this.src]={script:document.createElement("script"),
count:1};this.js=a.loaded[this.src];this.js.script.type=this.type;this.js.script.src=b;this.js.script.onload=c;a.head.appendChild(this.js.script)}return this};a.prototype.destroy=function(){this.js||(this.js=a.loaded[this.src]);--this.js.count;return 0==this.js.count?(a.head.removeChild(this.js.script),this.js=a.loaded[this.src]=null,!0):!1};a.getInstance=function(d,c){return new a(d,c)};a.head=document.getElementsByTagName("head")[0];a.loaded={};return a}();f.LoadJs=k})(DynamicLoad||(DynamicLoad=
{}));
(function(f){var k=function(){function a(){}a.enchantUrl=function(){var a=window.location.href,a=a.replace(/#+!+\/*|$/,"#!/"),c=a.indexOf("#!/")+3,b=a.slice(0,c),a=a.slice(c),a=a.replace(/\/{2,}/g,"/");0<a.length&&"/"==a.slice(-1)&&(a=a.slice(0,-1));a=b+a;(b=window.location.href==a)||window.location.replace(a);return b};a.uri=function(a){var c=window.location.href,b=c.indexOf("#!");return a?(window.location.replace(c.slice(0,-1==b?c.length:b)+"#!"+a),a):-1!=b?(a=c.slice(b+2,c.length))?a:"/":"/"};
a.path=function(){var a=this.uri(),c=a.indexOf("?"),b=a.indexOf("#"),e=a.length;-1!=c&&-1!=b?e=c<b?c:b:-1!=c&&-1==b?e=c:-1==c&&-1!=b&&(e=b);return a.slice(0,e).replace(/\/{2,}/g,"/")};a.query=function(a){var c=this.uri(),b=c.indexOf("?"),e=c.indexOf("#");return a?(a=(new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)")).exec(this.query()))?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null:c.slice(b,e<c.length&&b<e?e:c.length)};a.hash=function(){var a=this.uri(),c=a.indexOf("?"),b=a.indexOf("#");return a.slice(b+
1,c<a.length&&b<c?c:a.length)};return a}();f.Location=k})(DynamicLoad||(DynamicLoad={}));
(function(f){var k=function(){function a(){}a.uriListener=function(a){f.Location.enchantUrl()&&a();window.addEventListener("hashchange",function(){f.Location.enchantUrl()&&a()})};a.run=function(d){var c=function(b,d,k){var h=function(a){var b={},e=a[d];if(!e)for(var f=Object.keys(a),h=0;h<f.length;h++){var p=new RegExp("^"+f[h].replace(/\{\*}$/,"(.+)").replace(/\{([^\/]+)}/g,"([^\\/]+)")+"$");if(p.test(d)){for(var e=p.exec(f[h]).slice(1),p=p.exec(d).slice(1),l=0;l<e.length;l++)b[e[l].replace(/^\{(.+)}$/,
"$1")]=p[l];e=a[f[h]];break}}"string"==typeof e?c(e,d,k):k(e,b)};a.routes[b]?h(a.routes[b]):f.Http.get(b).addCallback(function(c,d){a.routes[b]=d;h(d)}).asJson()},b=function(a,b,c,d){if(a){a=a.split(".");for(var f=0;f<a.length;f++)if(b[a[f]])b=b[a[f]];else return;"function"==typeof b&&b(d,c)}};a.uriListener(function(){for(var e=f.Location.path(),g=0;g<a.curJs.length;g++)a.curJs[g].options.reload&&(b(a.curJs[g].options.destroy,window,a.curJs[g].options.data,a.curParams),a.curJs[g].loadJs.destroy(),
a.curJs.splice(g,1),g--);var k=[],h=[],v=function(){a.curHtml&&(a.curHtml.destroy(),a.curHtml=null)},q=function(c){for(var d=0;d<a.curJs.length;d++)b(a.curJs[d].options.destroy,window,a.curJs[d].options.data,c),a.curJs[d].loadJs.destroy();a.curJs=k};c(d,e,function(c,d){var e={},g;for(g in a.curParams)a.curParams.hasOwnProperty(g)&&(e[g]=a.curParams[g]);a.curParams=d;if(c){var l=function(b){if(c.html){var d=document.getElementById("body");d||(d=document.getElementsByTagName("body")[0]);a.curHtml=f.LoadHtml.getInstance(c.html);
b&&a.curHtml.addCallback(b);a.curHtml.addCallback(function(){q(e)});a.curHtml.put(d)}else b&&b(),q(e),v()},w=function(d){for(var e=0;e<d.length;e++){var g=c.js[d[e]];k.push({loadJs:f.LoadJs.getInstance(d[e]).addCallback(function(){b(g.create,window,g.data,a.curParams)}).load(),options:g})}};(function(){if(c.css)for(var b=0;b<c.css.length;b++)h.push(f.LoadCss.getInstance(c.css[b]).load());for(b=0;b<a.curCss.length;b++)a.curCss[b].destroy();a.curCss=h})();if(c.js){var m=Object.keys(c.js);g=!1;for(var n=
0,t=0;n<m.length;n++)if(c.js[m[n]].preload){var u=c.js[m[n]];g=!0;t++;k.push({loadJs:f.LoadJs.getInstance(m[n]).addCallback(function(){b(u.create,window,u.data,a.curParams);t--;0==t&&l(function(){w(m)})}).load(),options:u});m.splice(n,1);n--}g||l(function(){w(m)})}else l()}else q(e),v()})})};a.routes={};a.curParams={};a.curCss=[];a.curJs=[];return a}();f.Route=k})(DynamicLoad||(DynamicLoad={}));
